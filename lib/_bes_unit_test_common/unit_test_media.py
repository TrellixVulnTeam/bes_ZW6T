#-*- coding:utf-8; mode:python; indent-tabs-mode: nil; c-basic-offset: 2; tab-width: 2 -*-

import binascii

from bes.text.text_replace import text_replace

class unit_test_media(object):
  
  def _decode(s):
    stripped = text_replace.replace_white_space(s, '').strip()
    return binascii.unhexlify(stripped)
    
  # 1x1 PNG file
  PNG_SMALLEST_POSSIBLE = _decode('''\
89504e47 0d0a1a0a 0000000d 49484452 00000001 00000001 08020000 00907753
de000001 84694343 50494343 2070726f 66696c65 00002891 7d913d48 c3401cc5
5f5b8b22 290e7610 71c850c5 c182a888 a356a108 1542add0 aa83c9a5 5fd0a421
49717114 5c0b0e7e 2c561d5c 9c757570 1504c10f 10373727 451729f1 7f49a145
8c07c7fd 7877ef71 f70e0836 2a4cb3ba c6014db7 cd743221 6673ab62 f72b0444
10c62804 9959c69c 24a5e03b beee11e0 eb5d9c67 f99ffb73 44d4bcc5 8080483c
cb0cd326 de209ede b40dcefb c4515692 55e273e2 31932e48 fcc875c5 e337ce45
97833c33 6a66d2f3 c45162b1 d8c14a07 b392a911 4f11c754 4da7fc60 d66395f3
1667ad52 63ad7bf2 170a797d 6599eb34 8790c422 96204184 821acaa8 c0469c56
9d140b69 da4ff8f8 075dbf44 2e855c65 30722ca0 0a0db2eb 07ff83df dd5a85c9
092f4948 00e117c7 f91806ba 778166dd 71be8f1d a7790284 9e812bbd edaf3680
994fd2eb 6d2d7604 f46d0317 d76d4dd9 032e7780 81274336 65570ad1 0c160ac0
fb197d53 0ee8bf05 7ad7bcde 5afb387d 0032d455 ea063838 04468a94 bdeef3ee
9ecedefe 3dd3eaef 0739c272 90d03aa8 a9000000 09704859 7300002e 2300002e
230178a5 3f760000 00077449 4d4507e5 0c0d052c 20b9539c c0000000 19744558
74436f6d 6d656e74 00437265 61746564 20776974 68204749 4d505781 0e170000
000c4944 415408d7 63f8ffff 3f0005fe 02fedccc 59e70000 00004945 4e44ae42
6082
''')

  # 1x1 JPG file
  JPG_SMALLEST_POSSIBLE = _decode('''\
ffd8ffe0 00104a46 49460001 01010048 00480000 fffe0013 43726561 74656420
77697468 2047494d 50ffe202 b0494343 5f50524f 46494c45 00010100 0002a06c
636d7304 3000006d 6e747252 47422058 595a2007 e5000c00 0d000500 28000c61
63737041 50504c00 00000000 00000000 00000000 00000000 00000000 00000000
00f6d600 01000000 00d32d6c 636d7300 00000000 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000d64
65736300 00012000 00004063 70727400 00016000 00003677 74707400 00019800
00001463 68616400 0001ac00 00002c72 58595a00 0001d800 00001462 58595a00
0001ec00 00001467 58595a00 00020000 00001472 54524300 00021400 00002067
54524300 00021400 00002062 54524300 00021400 00002063 68726d00 00023400
00002464 6d6e6400 00025800 00002464 6d646400 00027c00 0000246d 6c756300
00000000 00000100 00000c65 6e555300 00002400 00001c00 47004900 4d005000
20006200 75006900 6c007400 2d006900 6e002000 73005200 4700426d 6c756300
00000000 00000100 00000c65 6e555300 00001a00 00001c00 50007500 62006c00
69006300 20004400 6f006d00 61006900 6e000058 595a2000 00000000 00f6d600
01000000 00d32d73 66333200 00000000 010c4200 0005deff fff32500 00079300
00fd90ff fffba1ff fffda200 0003dc00 00c06e58 595a2000 00000000 006fa000
0038f500 00039058 595a2000 00000000 00249f00 000f8400 00b6c458 595a2000
00000000 00629700 00b78700 0018d970 61726100 00000000 03000000 02666600
00f2a700 000d5900 0013d000 000a5b63 68726d00 00000000 03000000 00a3d700
00547c00 004ccd00 00999a00 00266700 000f5c6d 6c756300 00000000 00000100
00000c65 6e555300 00000800 00001c00 47004900 4d00506d 6c756300 00000000
00000100 00000c65 6e555300 00000800 00001c00 73005200 470042ff db004300
03020203 02020303 03030403 03040508 05050404 050a0707 06080c0a 0c0c0b0a
0b0b0d0e 12100d0e 110e0b0b 10161011 13141515 150c0f17 18161418 12141514
ffdb0043 01030404 05040509 05050914 0d0b0d14 14141414 14141414 14141414
14141414 14141414 14141414 14141414 14141414 14141414 14141414 14141414
14141414 14ffc200 11080001 00010301 11000211 01031101 ffc40014 00010000
00000000 00000000 00000000 0008ffc4 00140101 00000000 00000000 00000000
00000000 ffda000c 03010002 10031000 0001549f ffc40014 10010000 00000000
00000000 00000000 0000ffda 00080101 00010502 7fffc400 14110100 00000000
00000000 00000000 000000ff da000801 0301013f 017fffc4 00141101 00000000
00000000 00000000 00000000 ffda0008 01020101 3f017fff c4001410 01000000
00000000 00000000 00000000 00ffda00 08010100 063f027f ffc40014 10010000
00000000 00000000 00000000 0000ffda 00080101 00013f21 7fffda00 0c030100
02000300 0000109f ffc40014 11010000 00000000 00000000 00000000 0000ffda
00080103 01013f10 7fffc400 14110100 00000000 00000000 00000000 000000ff
da000801 0201013f 107fffc4 00141001 00000000 00000000 00000000 00000000
ffda0008 01010001 3f107fff d9                                          
''')

  # the result of ffmpeg -f lavfi -i color=blue:s=1280x720 -vframes 1 out.mp4
  MP4_SMALLEST_POSSIBLE = _decode('''\
00000020 66747970 69736f6d 00000200 69736f6d 69736f32 61766331 6d703431
00000008 66726565 00000397 6d646174 000002af 0605ffff abdc45e9 bde6d948
b7962cd8 20d923ee ef783236 34202d20 636f7265 20313633 20723330 36302035
64623661 6136202d 20482e32 36342f4d 5045472d 34204156 4320636f 64656320
2d20436f 70796c65 66742032 3030332d 32303231 202d2068 7474703a 2f2f7777
772e7669 64656f6c 616e2e6f 72672f78 3236342e 68746d6c 202d206f 7074696f
6e733a20 63616261 633d3120 7265663d 33206465 626c6f63 6b3d313a 303a3020
616e616c 7973653d 3078333a 30783131 33206d65 3d686578 20737562 6d653d37
20707379 3d312070 73795f72 643d312e 30303a30 2e303020 6d697865 645f7265
663d3120 6d655f72 616e6765 3d313620 6368726f 6d615f6d 653d3120 7472656c
6c69733d 31203878 38646374 3d312063 716d3d30 20646561 647a6f6e 653d3231
2c313120 66617374 5f70736b 69703d31 20636872 6f6d615f 71705f6f 66667365
743d2d32 20746872 65616473 3d323220 6c6f6f6b 61686561 645f7468 72656164
733d3320 736c6963 65645f74 68726561 64733d30 206e723d 30206465 63696d61
74653d31 20696e74 65726c61 6365643d 3020626c 75726179 5f636f6d 7061743d
3020636f 6e737472 61696e65 645f696e 7472613d 30206266 72616d65 733d3320
625f7079 72616d69 643d3220 625f6164 6170743d 3120625f 62696173 3d302064
69726563 743d3120 77656967 6874623d 31206f70 656e5f67 6f703d30 20776569
67687470 3d32206b 6579696e 743d3235 30206b65 79696e74 5f6d696e 3d323520
7363656e 65637574 3d343020 696e7472 615f7265 66726573 683d3020 72635f6c
6f6f6b61 68656164 3d343020 72633d63 7266206d 62747265 653d3120 6372663d
32332e30 2071636f 6d703d30 2e363020 71706d69 6e3d3020 71706d61 783d3639
20717073 7465703d 34206970 5f726174 696f3d31 2e343020 61713d31 3a312e30
30008000 0000d865 8884002b fffed8e7 f32ca7f4 dabbf0ac c4998aa5 c3ab2f77
0a940d19 433b4f25 ea660000 03000003 00000300 0003000c 0a3e4316 35fa6495
d4000003 00000301 ee0001f0 00037400 0998001e c0006480 01c40007 f0002640
010d0007 d8003140 01d60000 03000003 00000300 00030000 03000003 00000300
00030000 03000003 00000300 00030000 03000003 00000300 00030000 03000003
00000300 00030000 03000003 00000300 00030000 03000003 00000300 00030000
03000003 00000300 00030000 03000003 00000300 00030000 03000003 0006cd00
0003186d 6f6f7600 00006c6d 76686400 00000000 00000000 00000000 0003e800
00002800 01000001 00000000 00000000 00000000 01000000 00000000 00000000
00000000 01000000 00000000 00000000 00000040 00000000 00000000 00000000
00000000 00000000 00000000 00000000 00000200 00024274 72616b00 00005c74
6b686400 00000300 00000000 00000000 00000100 00000000 00002800 00000000
00000000 00000000 00000000 01000000 00000000 00000000 00000000 01000000
00000000 00000000 00000040 00000005 00000002 d0000000 00002465 64747300
00001c65 6c737400 00000000 00000100 00002800 00000000 01000000 0001ba6d
64696100 0000206d 64686400 00000000 00000000 00000000 00320000 00020055
c4000000 00002d68 646c7200 00000000 00000076 69646500 00000000 00000000
00000056 6964656f 48616e64 6c657200 00000165 6d696e66 00000014 766d6864
00000001 00000000 00000000 00000024 64696e66 0000001c 64726566 00000000
00000001 0000000c 75726c20 00000001 00000125 7374626c 000000c1 73747364
00000000 00000001 000000b1 61766331 00000000 00000001 00000000 00000000
00000000 00000000 050002d0 00480000 00480000 00000000 00010000 00000000
00000000 00000000 00000000 00000000 00000000 00000000 00000018 ffff0000
00376176 63430164 001fffe1 001a6764 001facd9 405005bb 01100000 03001000
00030320 f1831960 01000668 ebe3cb22 c0fdf8f8 00000000 10706173 70000000
01000000 01000000 14627472 74000000 000002c7 b80002c7 b8000000 18737474
73000000 00000000 01000000 01000002 00000000 1c737473 63000000 00000000
01000000 01000000 01000000 01000000 14737473 7a000000 00000003 8f000000
01000000 14737463 6f000000 00000000 01000000 30000000 62756474 61000000
5a6d6574 61000000 00000000 2168646c 72000000 00000000 006d6469 72617070
6c000000 00000000 00000000 002d696c 73740000 0025a974 6f6f0000 001d6461
74610000 00010000 00004c61 76663538 2e37362e 313030                    
''')

  # the result of dd if=/dev/urandom of=unknown.bin count=2
  UNKNOWN = _decode('''\
0dea3ce0 4e07b0e6 73c2c7c8 7bedd787 7146825c a17887a0 5c3dcd3c f33d533a
6b2ec83e 4d731416 cc68e443 e27d0659 9678cddb 41a27c69 5e3a4b86 b6c06bc4
f8cf6b9e b65af690 92cf39fd 3a5e5a54 1191c24f ebaddc26 e71ae3f2 1738f30e
4d7e3a67 29012f24 314e549f dbb15c25 8fd2bd0e d63d1a29 3b66439f caa45ae5
bda0b1d4 218e9dbd f68690c8 c97fe9fc 6777e86e 44a6c1a4 00e6fb77 9e727f36
a63bca13 6c14323c ec0be513 611365f8 114a9196 4e958789 59783020 b84c6f8a
b2b9efc6 9ecde5c3 36836eac 2f408dbd f52312a5 f4309fbc 7ff0961d 829ee495
ba82c2cb a29d7ff8 56d204cb cbace957 d6627b20 819116fb 192bc35e 911a77ec
1456c2e1 f1796432 47bf0f88 6f00bd64 882c132a 42ec0393 11f5fb86 30e1234a
f374f54e 61ceef65 b29e3b1e fb6a88de 5aff5a18 52893135 f070e904 cfced955
47246100 ffcb1b69 1e3824cb dc6da361 349080d6 67a67713 009dbd3a 7639f933
3ed8ddb4 fa7edab5 2b511f29 10121309 d8ad7287 55f746bd 06c3b0e2 7260a1d5
86d3834c 41d2b6f0 d6330653 5741e0ac d9a239da fe63f254 d32e123d 255adbad
608864b0 1c258443 de716fbd 88a8ae0b b6410ffe a790b223 453d1872 95db96cf
1d2bd65e ec4e6d9e e5e7cd2c 711422ea 9e494fc6 7af34f97 ba7f8811 a9a99ec3
3662559b a2a66c62 079741b2 a7322187 30cf84d6 5483b4ec d67d6272 6b95a1ad
02d138a4 70be500e 53369904 f9b8489c a5495c2e 4fc5eee0 35369aa1 f3e21ce5
c01cf2e0 24ffa0a4 fdc0eb59 9b7d9d70 da5a3d84 1f98c466 daa86ff3 8eb5b13f
c3af4bca 1192f878 264e6a70 18b06fc7 ac87ccc9 c6bddcdf 62853021 50cd176b
3020f158 51e1f241 e1752e75 91e6f2f1 dfe40457 aa7bee75 816ace71 da1695bf
f194c489 e64afa5a 442ca159 6e7f971a 15335c5e cead9b1d 5d22b459 454cf3bb
36839c77 e4e3b612 3a5c3dd9 5bdcac8d 05ae4672 0b5c248c 1b036e57 376394f5
5e580e53 7c9351e3 b42b1e15 e0e014ae cb92d6a1 684221ff 4bf53c0b 4fa2d254
ebc63384 c7eb1be6 be336e42 478aaa74 a90dbd87 a6051576 dbaca0da 4c1eebe8
88b22ddc 03e1eb90 aa8fd3a6 ed206871 0f4aa6e6 5f70af5f d86c3f0e aac82643
36a12160 1e6c7bc4 0370dc74 53e60e7d 34cdee23 a1c426b3 fa77f113 756590f1
bc4cbf25 912e93a1 be906d28 7a2c67aa 59a88b01 7e3fc6b7 0d2afae4 9653efbf
3a80c451 883cd430 2a3a93dd d45c0509 1697ab19 5161ffe2 477c3111 cf227b59
70923c4d 26656d10 cffb60d2 01bb0547 c99c1b4f 1da737b7 0614770e 36412faf
accda2ef e116350f bf67ac3e 42cfeb7d 86b3eafd 2d95e4ff f17d8878 28c5a621
7a469912 6b98e139 27832b1e 445a6828 9c137448 2521c996 d02c88a1 c1b4b66d
c20a37e7 bbba8342 2f43db66 a04524b4 8b2d53d9 8ce7772d 641ed572 8fea47da
''')
